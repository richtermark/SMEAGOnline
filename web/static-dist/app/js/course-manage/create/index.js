webpackJsonp(["app/js/course-manage/create/index"],{0:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n("423d5c93d4f10f876e3b"),o=i(r),l=function(){function e(){s(this,e),this.validator=null,this.init()}return a(e,[{key:"init",value:function(){$('[data-toggle="popover"]').popover({html:!0}),this.initValidator(),this.initExpiryMode(),this.checkBoxChange()}},{key:"initValidator",value:function(){var e=this,t=$("#course-create-form");this.validator=t.validate({groups:{date:"expiryStartDate expiryEndDate"},rules:{title:{required:!0,trim:!0}},messages:{title:Translator.trans("请输入教学计划课程标题")}}),$("#course-submit").click(function(n){e.validator.form()&&(e.isInitIntro(),$(n.currentTarget).button("loading"),t.submit())}),this.initDatePicker("#expiryStartDate"),this.initDatePicker("#expiryEndDate"),this.initDatePicker("#deadline")}},{key:"isInitIntro",value:function(){var e=$("#courses-list-table").find("tbody tr").length;if(1==e){var t=new o.default;t.isSetCourseListCookies()}}},{key:"checkBoxChange",value:function(){var e=this;$('input[name="deadlineType"]').on("change",function(t){"end_date"==$('input[name="deadlineType"]:checked').val()?($("#deadlineType-date").removeClass("hidden"),$("#deadlineType-days").addClass("hidden")):($("#deadlineType-date").addClass("hidden"),$("#deadlineType-days").removeClass("hidden")),e.initExpiryMode()}),$('input[name="expiryMode"]').on("change",function(t){"date"==$('input[name="expiryMode"]:checked').val()?($("#expiry-days").removeClass("hidden").addClass("hidden"),$("#expiry-date").removeClass("hidden")):"days"==$('input[name="expiryMode"]:checked').val()?($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden"),$('input[name="deadlineType"][value="days"]').prop("checked",!0)):($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden").addClass("hidden")),e.initExpiryMode()}),$('input[name="learnMode"]').on("change",function(e){"freeMode"==$('input[name="learnMode"]:checked').val()?($("#learnLockModeHelp").removeClass("hidden").addClass("hidden"),$("#learnFreeModeHelp").removeClass("hidden")):($("#learnFreeModeHelp").removeClass("hidden").addClass("hidden"),$("#learnLockModeHelp").removeClass("hidden"))})}},{key:"initDatePicker",value:function(e){var t=this,n=$(e);n.datetimepicker({format:"yyyy-mm-dd",language:"zh",minView:2,autoclose:!0,endDate:new Date(Date.now()+31536e7)}).on("hide",function(){t.validator.form()}),n.datetimepicker("setStartDate",new Date)}},{key:"initExpiryMode",value:function(){var e=$('[name="deadline"]'),t=$('[name="expiryDays"]'),n=$('[name="expiryStartDate"]'),i=$('[name="expiryEndDate"]'),s=$('[name="expiryMode"]:checked').val();switch(this.elementRemoveRules(e),this.elementRemoveRules(t),this.elementRemoveRules(n),this.elementRemoveRules(i),s){case"days":var a=$('[name="deadlineType"]:checked');if("end_date"===a.val())return this.elementAddRules(e,this.getDeadlineEndDateRules()),void this.validator.form();this.elementAddRules(t,this.getExpiryDaysRules()),this.validator.form();break;case"date":this.elementAddRules(n,this.getExpiryStartDateRules()),this.elementAddRules(i,this.getExpiryEndDateRules()),this.validator.form()}}},{key:"getExpiryEndDateRules",value:function(){return{required:!0,date:!0,after_date:"#expiryStartDate",messages:{required:Translator.trans("请输入结束日期")}}}},{key:"getExpiryStartDateRules",value:function(){return{required:!0,date:!0,after_now_date:!0,before_date:"#expiryEndDate",messages:{required:Translator.trans("请输入开始日期")}}}},{key:"getExpiryDaysRules",value:function(){return{required:!0,positive_integer:!0,max_year:!0,messages:{required:Translator.trans("请输入有效期天数")}}}},{key:"getDeadlineEndDateRules",value:function(){return{required:!0,date:!0,after_now_date:!0,messages:{required:Translator.trans("请输入截至日期")}}}},{key:"elementAddRules",value:function(e,t){e.rules("add",t)}},{key:"elementRemoveRules",value:function(e){e.rules("remove")}}]),e}();new l},"423d5c93d4f10f876e3b":function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n("c827e50af562939444ba");var r=n("7ddc50f4d1e6e5cdafdb"),o=i(r),l="COURSE_BASE_INTRO",u="COURSE_TASK_INTRO",d="COURSE_TASK_DETAIL_INTRO",c="COURSE_LIST_INTRO",p="COURSE_LIST_INTRO_COOKIE",h=function(){function e(){var t=this;s(this,e),this.intro=null,this.customClass="es-intro-help multistep",$("body").on("click",".js-skip",function(e){t.intro.exit()})}return a(e,[{key:"introType",value:function(){return this.isTaskCreatePage()?void this.initTaskCreatePageIntro():this.isCourseListPage()?void this.initCourseListPageIntro():void this.initNotTaskCreatePageIntro()}},{key:"isCourseListPage",value:function(){return!!$("#courses-list-table").length}},{key:"isTaskCreatePage",value:function(){return!!$("#step-3").length}},{key:"isInitTaskDetailIntro",value:function(){return $(".js-task-manage-item").attr("into-step-id","step-5"),!!$(".js-settings-list").length}},{key:"introStart",value:function(e){var t=this,n='<i class="es-icon es-icon-close01"></i>';this.intro=introJs(),e.length<2?(n="我知道了",this.customClass="es-intro-help"):this.customClass="es-intro-help multistep",this.intro.setOptions({steps:e,skipLabel:n,nextLabel:"继续了解",prevLabel:"上一步",doneLabel:n,showBullets:!1,tooltipPosition:"auto",showStepNumbers:!1,exitOnEsc:!1,exitOnOverlayClick:!1,tooltipClass:this.customClass}),this.intro.start().onexit(function(){}).onchange(function(){t.intro._currentStep==t.intro._introItems.length-1?$(".introjs-nextbutton").before('<a class="introjs-button  done-button js-skip">我知道了<a/>'):$(".js-skip").remove()})}},{key:"initTaskCreatePageIntro",value:function(){$(".js-task-manage-item:first .js-item-content").trigger("click"),store.get(l)||store.get(u)?store.get(u)||(store.set(u,!0),this.introStart(this.initTaskSteps())):(store.set(l,!0),store.set(u,!0),this.introStart(this.initAllSteps()))}},{key:"initTaskDetailIntro",value:function(e){store.get(d)||(store.set(d,!0),this.introStart(this.initTaskDetailSteps(e)))}},{key:"initNotTaskCreatePageIntro",value:function(){store.get(l)||(store.set(l,!0),this.introStart(this.initNotTaskPageSteps()))}},{key:"isSetCourseListCookies",value:function(){store.get(c)||o.default.set(p,!0)}},{key:"initCourseListPageIntro",value:function(){var e=this,t=$("#courses-list-table").find("tbody tr").length;2===t&&!store.get(c)&&o.default.get(p)&&(o.default.remove(p),new Promise(function(e,t){setTimeout(function(){var t=$(".js-sidenav-course-menu");return t.length?void $(".js-sidenav-course-menu").slideUp(function(){e()}):void e()},100)}).then(function(){setTimeout(function(){e.initCourseListIntro(".js-sidenav")},100)}))}},{key:"initCourseListIntro",value:function(e){store.get(c)||(store.set(c,!0),this.introStart(this.initCourseListSteps(e)))}},{key:"initAllSteps",value:function(){var e=[{intro:'<p class="title">功能升级</p>\n        课程管理功能现已全新升级。'},{element:"#step-1",intro:'<p class="title">计划任务</p>\n        教学内容的编辑、管理请点击左侧“计划任务”的菜单项进入。'},{element:"#step-2",intro:'<p class="title">营销设置</p>\n        在“营销设置”中您可以通过设置决定课程如何销售、如何加入、如何学习。'},{element:"#step-3",intro:'<p class="title">添加任务</p>\n        您可以在这里选择各种不同的教学手段，然后上传文件/设置内容/设置学习完成条件。'}];return this.isInitTaskDetailIntro()&&(e.push({element:'[into-step-id="step-5"]',intro:'<p class="title">任务环节</p>\n        在设计学习任务时，您可以按照课时去设置预习、学习、练习、作业、课外这几个环节，\n        每个环节都可以通过各种教学手段来实现。'}),store.get(d)||store.set(d,!0)),e}},{key:"initNotTaskPageSteps",value:function(){return[{intro:'<p class="title">功能升级</p>\n        课程管理功能现已全新升级。'},{element:"#step-1",intro:'<p class="title">计划任务</p>\n        教学内容的编辑、管理请点击左侧“计划任务”的菜单项进入。'},{element:"#step-2",intro:'<p class="title">营销设置</p>\n        在“营销设置”中您可以通过设置决定课程如何销售、如何加入、如何学习。'}]}},{key:"initTaskSteps",value:function(){var e=[{element:"#step-3",intro:'<p class="title">添加任务</p>\n        您可以在这里选择各种不同的教学手段，然后上传文件/设置内容/设置学习完成条件。'}];return this.isInitTaskDetailIntro()&&(e.push({element:"#step-5",intro:'<p class="title">任务环节</p>\n        在设计学习任务时，您可以按照课时去设置预习、学习、练习、作业、课外这几个环节，\n        每个环节都可以通过各种教学手段来实现。',position:"bottom"}),store.get(d)||store.set(d,!0)),e}},{key:"initTaskDetailSteps",value:function(e){return[{element:e,intro:'<p class="title">任务环节</p>\n        在设计学习任务时，您可以按照课时去设置预习、学习、练习、作业、课外这几个环节，\n        每个环节都可以通过各种教学手段来实现。',position:"bottom"}]}},{key:"initCourseListSteps",value:function(e){return[{element:e,intro:'\n          <p class="title">多个教学计划</p>\n          恭喜你创建了多个教学计划！左侧的功能菜单会有所简化，\n          只会显示课程公共的相关设置。'}]}},{key:"initResetStep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[{element:".js-intro-btn-group",intro:'<div class="btn-content"><p><a class=\'btn btn-success js-reset-intro '+e+"'>查看引导</a></p>\n        <a class='btn btn-info'>完整教程</a><div>",position:"top"}]}}]),e}();t.default=h}});