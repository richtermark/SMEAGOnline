webpackJsonp(["app/js/activity/live/index"],{0:function(t,n,a){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}var s=a("c6797855be84e924b7d5"),i=e(s);window.liveShow=new i.default},c6797855be84e924b7d5:function(t,n,a){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function s(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,n){for(var a=0;a<n.length;a++){var e=n[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,a,e){return a&&t(n.prototype,a),e&&t(n,e),n}}(),r=a("da32dea28c2b82c7aab1"),o=e(r),l=function(){function t(){s(this,t),this.init()}return i(t,[{key:"init",value:function(){var t=this,n="1"==$("#lesson-live-content").data("hasRoom");if(!n)return $("#lesson-live-content").find(".lesson-content-text-body").html("<div class='live-show-item'>\n        <p class='title'>直播说明</p>\n        <p>直播教室尚未创建！</p>\n        </div>"),void $("#lesson-live-content").show();var a=JSON.parse($("#activity-data").html()),e=(parseInt(a.startTime),parseInt(a.endTime)),s=parseInt(a.nowDate);this.liveStartTimeFormat=a.startTimeFormat,this.liveEndTimeFormat=a.endTimeFormat;var i=a.fromCourseId,r=a.id;this.summary=$("#activity-summary").text(),this.$liveNotice='<div class="live-show-item">\n          <p class="title">直播时间</p>\n          <p>直播将于'+this.liveStartTimeFormat+"开始，于"+this.liveEndTimeFormat+"结束<p>\n          (请在课前10分钟内提早进入)\n         </div>",this.iID=null,this.iID&&clearInterval(iID),this.intervalSecond=0,this.entry_url=location.protocol+"//"+location.hostname+"/course/"+i+"/activity/"+r+"/live_entry",this.generateHtml();var o=0;e>s&&(o=1e3),this.iID=setInterval(function(){t.generateHtml()},o),$("#lesson-live-content").show(),this.started=!1}},{key:"entryLiveRoom",value:function(){if(!this.started){this.started=!0;var t=new o.default;t.emit("start",{}).then(function(){}).catch(function(t){})}window.open(this.entry_url,"_blank")}},{key:"generateHtml",value:function(){var t=JSON.parse($("#activity-data").text()),n=parseInt(t.startTime),a=parseInt(t.endTime),e=parseInt(t.nowDate);e+=this.intervalSecond;var s=parseInt(n-e),i=parseInt(a-e),r=Math.floor(s/86400),o=s%86400,l=Math.floor(o/3600);o%=3600;var c=Math.floor(o/60),v=o%60,h=Translator.trans("老师们：");h+=1==t.ext.liveProvider?Translator.trans("录制直播课程时，需在直播课程间点击")+"\n          <span class='color-info'>"+Translator.trans("录制面板")+"</span>，"+Translator.trans("，录制完成后点击")+"\n          <span class='color-info'>"+Translator.trans("暂停")+"</span>"+Translator.trans("结束录播，录播结束后在")+"\n          <span class='color-info'>"+Translator.trans("录播管理")+"</span>"+Translator.trans("界面生成回放。")+"。\n        ":Translator.trans("直播平台")+"\n        <span class='color-info'>"+Translator.trans("下课后")+"</span>"+Translator.trans("且")+"\n        <span class='color-info'>"+Translator.trans("直播时间")+"</span>"+Translator.trans("结束后，在课时管理的")+"\n        <span class='color-info'>"+Translator.trans("录播管理")+"</span>"+Translator.trans("点击生成回放。")+"\n        ",h="<div class='live-show-item'>"+h+"</div>";var d=this._getCountDown(r,l,c,v),p="";0<s&&s<7200&&(this.$liveNotice='<div class="live-show-item">\n          <p class="title">直播时间</p>\n          <p>直播将于'+this.liveStartTimeFormat+"开始，于"+this.liveEndTimeFormat+"结束<p>\n          (请在课前10分钟内提早进入)\n         </div>",p="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n            "+Translator.trans("进入直播教室")+"\n          </a>\n        </div>",t.isTeacher&&(p+=h)),s<=0&&(clearInterval(this.iID),d="",this.$liveNotice="<div class='live-show-item'>\n          <p class=\"title\">直播时间</p>\n          直播已经开始，直播将于"+this.liveEndTimeFormat+"结束。\n        </div>",p="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n            "+Translator.trans("进入直播教室")+"\n          </a>\n        </div>",t.isTeacher&&(p+=h)),i<=0&&(d="",p="",this.$liveNotice="<div class='live-show-item'>\n          <i class='es-icon es-icon-xinxi color-danger icon-live-end'></i>\n          "+Translator.trans("直播已经结束")+"\n        </div>",t.replays&&t.replays.length>0&&($.each(t.replays,function(t,n){p+="<a class='btn btn-primary btn-replays' href='"+n.url+"' target='_blank'>"+n.title+"</a>"}),p="<div class='live-show-item'>"+p+"</div>"));var m=this.$liveNotice+" "+d+"\n      <div class='live-show-item'>\n        <p class='title'>直播说明</p>\n        "+this.summary+"\n      </div>"+p;$("#lesson-live-content").find(".lesson-content-text-body").html(m),this.intervalSecond++}},{key:"_getCountDown",value:function(t,n,a,e){var s="";return s+=t?t+Translator.trans(" 天 "):"",s+=n?n+Translator.trans(" 小时 "):"",s+=a?a+Translator.trans(" 分钟 "):"",s+=e?e+Translator.trans(" 秒 "):"",s="<div class='live-show-item'>\n      <p class='title'>"+Translator.trans("倒计时")+'</p>\n      <span class="color-warning">'+s+"</span>\n    </div>"}}]),t}();n.default=l}});