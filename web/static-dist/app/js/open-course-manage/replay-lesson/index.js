webpackJsonp(["app/js/open-course-manage/replay-lesson/index"],[function(t,n,e){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function s(){var t=$(".lesson-manage-panel").data("file-status-url");$.get(t,"",function(t){if(t&&0!=t.length)for(var n=0;n<t.length;n++){var e=t[n];"waiting"==e.convertStatus||"doing"==e.convertStatus?$("li[data-file-id="+e.id+"]").find('span[data-role="mediaStatus"]').append("<span class='text-warning'>"+Translator.trans("正在文件格式转换")+"</span>"):"error"==e.convertStatus?$("li[data-file-id="+e.id+"]").find('span[data-role="mediaStatus"]').append("<span class='text-danger'>"+Translator.trans("文件格式转换失败")+"</span>"):"success"==e.convertStatus&&($("li[data-file-id="+e.id+"]").find(".mark-manage").show(),$("li[data-file-id="+e.id+"]").find(".mark-manage-divider").show())}})}var r=e("8f840897d9471c8c1fbd"),o=a(r),i=e("b334fd7e4c5a19234db2"),d=a(i),l=function(t,n){$.post(n.data("sortUrl"),{ids:t},function(t){var e=chapterNum=unitNum=0;n.find(".item-lesson, .item-chapter").each(function(){var t=$(this);t.hasClass("item-lesson")?(e++,t.find(".number").text(e)):t.hasClass("item-chapter-unit")?(unitNum++,t.find(".number").text(unitNum)):t.hasClass("item-chapter")&&(chapterNum++,unitNum=0,t.find(".number").text(chapterNum))})})},c=$("#course-item-list");(0,o.default)({element:"#course-item-list",itemSelector:".item-lesson, .item-chapter"},function(t){l(t,c)}),c.on("click",".delete-lesson-btn",function(t){if(confirm(Translator.trans("删除课时的同时会删除课时的资料、测验。您真的要删除该课时吗？"))){var n=$(t.currentTarget),e=function(){return n.parents(".item-chapter")[0]},a=function(){e()?n.parents(".item-chapter").remove():n.parents(".item-lesson").remove()};$.post($(this).data("url"),function(t){a(),l(c),(0,d.default)("success",Translator.trans("课时已删除！"))},"json")}}),c.on("click",".delete-chapter-btn",function(t){var n=$(this).data("chapter"),e=$(this).data("part");if(confirm(Translator.trans("您真的要删除该%chapter_name%%part_name%吗？",{chapter_name:n,part_name:e}))){var a=$(t.currentTarget);$.post($(this).data("url"),function(t){a.parents(".item-chapter").remove(),l(c),(0,d.default)("success"+n+e+Translator.trans("已删除！"))},"json")}}),c.on("click",".replay-lesson-btn",function(t){confirm(Translator.trans("您真的要录制回放吗？"))&&$.post($(this).data("url"),function(t){if(t.error)10019==t.code?(0,d.default)("danger",Translator.trans("录制失败，直播时您没有进行录制！")):1403==t.code?(0,d.default)("danger",Translator.trans("尚未生成回放文件!")):(0,d.default)("danger",Translator.trans("录制失败！"));else{var n="#"+$(t).attr("id");$(n).replaceWith(t),(0,d.default)("success",Translator.trans("课时已录制！"))}})}),c.on("click",".publish-lesson-btn",function(t){$(t.currentTarget);$.post($(this).data("url"),function(t){var n="#"+$(t).attr("id");$(n).find(".item-content .unpublish-warning").remove(),$(n).find(".item-actions .publish-lesson-btn").parent().addClass("hidden").removeClass("show"),$(n).find(".item-actions .unpublish-lesson-btn").parent().addClass("show").removeClass("hidden"),$(n).find(".item-actions .delete-lesson-btn").parent().addClass("hidden").removeClass("show"),$(n).find(".btn-link").tooltip(),(0,d.default)("success",Translator.trans("课时发布成功！"))})}),c.on("click",".unpublish-lesson-btn",function(t){$(t.currentTarget);$.post($(this).data("url"),function(t){var n="#"+$(t).attr("id");0==$(n).find(".item-content").find(".unpublish-warning").length&&($(n).find(".item-content").append('<span class="unpublish-warning text-warning">('+Translator.trans("未发布")+")</span>"),$(n).find(".item-actions .publish-lesson-btn").parent().addClass("show").removeClass("hidden"),$(n).find(".item-actions .unpublish-lesson-btn").parent().addClass("hidden").removeClass("show"),$(n).find(".item-actions .delete-lesson-btn").parent().addClass("show").removeClass("hidden"),$(n).find(".btn-link").tooltip(),(0,d.default)("success",Translator.trans("课时已取消发布！")))})}),c.on("click",".delete-exercise-btn",function(t){if(confirm(Translator.trans("您真的要删除该课时练习吗？"))){$(t.currentTarget);$.post($(this).data("url"),function(t){(0,d.default)("success",Translator.trans("练习已删除！")),window.location.reload()},"json")}}),c.on("click",".delete-homework-btn",function(t){if(confirm(Translator.trans("您真的要删除该课时作业吗？"))){$(t.currentTarget);$.post($(this).data("url"),function(t){(0,d.default)("success",Translator.trans("作业已删除！")),window.location.reload()},"json")}}),$("#course-item-list .item-actions .btn-link").tooltip(),$("#course-item-list .fileDeletedLesson").tooltip(),$(".dropdown-menu").parent().on("shown.bs.dropdown",function(){"block"==$(this).find(".dropdown-menu-more").css("display")?($(this).parent().find(".dropdown-menu-more").mouseout(function(){$(this).parent().find(".dropdown-menu-more").hide()}),$(this).parent().find(".dropdown-menu-more").mouseover(function(){$(this).parent().find(".dropdown-menu-more").show()})):$(this).parent().find(".dropdown-menu-more").show()}),$(".dropdown-menu").parent().on("hide.bs.dropdown",function(){$(this).find(".dropdown-menu-more").show()}),s(),$(".js-lesson-batch-btn-popover").popover({html:!0,trigger:"hover",delay:{show:200,hide:1e3},placement:"top",template:'<div class="popover tata-popover tata-popover-lg" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:function(){var t=$(this).find(".popover-content").html();return t}})}]);