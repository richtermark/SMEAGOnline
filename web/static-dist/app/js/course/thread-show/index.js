webpackJsonp(["app/js/course/thread-show/index"],[function(t,a){"use strict";var o=CKEDITOR.replace("post_content",{toolbar:"Thread",filebrowserImageUploadUrl:$("#post_content").data("imageUploadUrl")});o.on("change",function(){$("#post_content").val(o.getData())}),o.on("blur",function(){$("#post_content").val(o.getData())});var e=$("#thread-post-form"),r=e.validate({rules:{"post[content]":{required:!0}}});$(".js-btn-thread-post-form-save").click(function(){if(r.form()){$(".js-btn-thread-post-form-save").button("loading"),$(".thread-post-list").find("li.empty").remove();var t=$("#thread-post-form");$.ajax({url:t.attr("action"),type:"post",data:t.serialize(),success:function(a){$(".js-btn-thread-post-form-save").button("reset"),$("#thread-post-num").text(parseInt($("#thread-post-num").text())+1);var e=$(a).appendTo(".thread-post-list").attr("id");o.setData(""),$(".js-attachment-list").empty(),$(".js-attachment-ids").val(""),$(".js-upload-file").removeClass("hidden"),t.find("[type=submit]").removeAttr("disabled"),window.location.href="#"+e},error:function(t){$(".js-btn-thread-post-form-save").button("reset"),t=$.parseJSON(t.responseText),t.error?Notify.danger(t.error.message):Notify.danger(Translator.trans("发表回复失败，请重试"))}})}}),$("[data-role=confirm-btn]").click(function(){var t=$(this);return!!confirm(t.data("confirmMessage"))&&void $.post(t.data("url"),function(){var a=t.data("afterUrl");a?window.location.href=a:window.location.reload()})}),$(".thread-post-list").on("click",".thread-post-action",function(){var t=$(this).data("user");o.focus(),o.insertHtml("@"+t+"&nbsp;")}),$(".thread-post-list").on("click","[data-action=post-delete]",function(){if(!confirm(Translator.trans("您真的要删除该回帖吗？")))return!1;var t=$(this);$.post(t.data("url"),function(){window.location.reload()})})}]);